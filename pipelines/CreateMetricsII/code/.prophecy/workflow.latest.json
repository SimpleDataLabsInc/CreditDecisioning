{
  "metainfo" : {
    "id" : "1",
    "language" : "python",
    "fabricId" : "990",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "Year",
          "kind" : {
            "type" : "long",
            "value" : 2018
          },
          "optional" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "2018",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "createmetricsii"
  },
  "connections" : [ {
    "id" : "59CP6T27NNvrEFAsljfOt",
    "source" : "nLIeU1vq5Y1haW-6Z5SHm$$bTVNtL8ujdRPnsmrmSeF8",
    "sourcePort" : "-DKYPXr6cpyCf0m3aYm9R$$ekx_RsHVb4LM-Y1iIieoW",
    "target" : "N8XI4b0r41C98r4zJGXuY$$bwVgU5qdz8UYsK-G0EGLP",
    "targetPort" : "Z_q192QmqjgUxWDHvvuqy$$BiTJ-euN970OFDPstE4KF"
  }, {
    "id" : "EsT3Ove9uwkUlJV09g2vW",
    "source" : "KhKGpWIjs4Cl8SPLZTLfq$$-POKihJ5Q8C6wyL38xNAA",
    "sourcePort" : "8dhc6TDyIigVGNa5lrrVF$$z2LiDxgpPswa2reGpVW0x",
    "target" : "N8XI4b0r41C98r4zJGXuY$$bwVgU5qdz8UYsK-G0EGLP",
    "targetPort" : "51sdRfkjiTW8i3MV-BiCW$$AiYpxhPTrV1dCQMOXy3No"
  }, {
    "id" : "74H-RcFLL_4y7Uz0v1cCX",
    "source" : "wfS3tSSomjQ63ydrAyeFN$$3Cvz4wtDJIU-Sm77itsJi",
    "sourcePort" : "-rz8MhLfHBlkbZ2nJBz31$$TLnXoClALuxirKNvjJIa8",
    "target" : "lY9BF_UpAoekPkG8V11tN$$6PPoFoXHN8BCUS126QJ2_",
    "targetPort" : "sgKEun3wI8uK97QKsE5uh$$bNTxoEfSDHu6LyCVB_U-9"
  }, {
    "id" : "bXAZj2K4IJVQNhzJckDX-",
    "source" : "zOH5C3GtqrsEPwEFJGOLi$$T_JwgqlKsW9ud30cPrY_j",
    "sourcePort" : "2ZIMo6Fee-eMAmdjSDcvI$$A90_RUsr5enWOEWWLZx-Z",
    "target" : "ya9_cxbGeuUPref1-HAu2$$4-hNZHhJpOOC8NbX7SpsE",
    "targetPort" : "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT"
  }, {
    "id" : "ZtRkAAqU2CHDKDX7UsVvO",
    "source" : "lY9BF_UpAoekPkG8V11tN$$6PPoFoXHN8BCUS126QJ2_",
    "sourcePort" : "2Njm_vQelmN9u8aO-FLr_$$RgFvRuluavDy_PX75aEbw",
    "target" : "ya9_cxbGeuUPref1-HAu2$$4-hNZHhJpOOC8NbX7SpsE",
    "targetPort" : "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk"
  }, {
    "id" : "C2twkFnVH6NO5xTrYKX4t",
    "source" : "ya9_cxbGeuUPref1-HAu2$$4-hNZHhJpOOC8NbX7SpsE",
    "sourcePort" : "N_Zqvvvx1coa37Ndr7Pw_$$DJGIPh_qL8pwEgQfl7Ova",
    "target" : "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S",
    "targetPort" : "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc"
  }, {
    "id" : "wpq0x9_r07CIjo7NIXj4F",
    "source" : "N8XI4b0r41C98r4zJGXuY$$bwVgU5qdz8UYsK-G0EGLP",
    "sourcePort" : "ihSbdkfKW7G-TxkXIu58S$$DfsjIDeb-y5SlX1kgjbOE",
    "target" : "zOH5C3GtqrsEPwEFJGOLi$$T_JwgqlKsW9ud30cPrY_j",
    "targetPort" : "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW"
  }, {
    "id" : "CvJ3SKfjRu0utfj0uSyum",
    "source" : "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S",
    "sourcePort" : "lqDcEDYMFtjFo_AY7WlvY$$BkXNk5IYhdQ3RDsc3Byna",
    "target" : "OYaGutOo1n_DqxjKU-7G_$$R2yardQiDMwyz3efeWlLu",
    "targetPort" : "8pBqFHg4j9yqVWrPgnCr5$$-gsoGb9UJxu4Wv0_AxPZ4"
  }, {
    "id" : "YNb23PsLy15o7P5Nn7VbX",
    "source" : "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S",
    "sourcePort" : "lqDcEDYMFtjFo_AY7WlvY$$BkXNk5IYhdQ3RDsc3Byna",
    "target" : "YRpIP1W9KuR198nbz1_kL$$6RHbqvxXN_BHsWC9nQOXb",
    "targetPort" : "FqNGAwu-FsXLmp-s6FpwA$$4B-nYdsGZ6z3SQcaaR6wu"
  }, {
    "id" : "oQCzc64ICvcCbTvkTePTQ",
    "source" : "PQOLTdXX7yyiKT10fr_eR$$w-fNGp-QQFHCO_0YakWFh",
    "sourcePort" : "t0_sQuUJ8VoqSrIgFB6OO$$hRRMGAycfoonb_w2TTLj7",
    "target" : "UGvWJ-rcmwcFxAdXZbPM-$$U-Ppg_VPlLrEGh7royJKA",
    "targetPort" : "2sH4WuE25a33TlKYWm9vI$$18YyvpQyJMvva6tdqrtHK"
  }, {
    "id" : "o10XZX6gYy1khIjcEH3bD",
    "source" : "Ovegni1Ik2s62v3Y_KxzA$$Z7UtxkHpo8l4seeHGyTJz",
    "sourcePort" : "EKT04cbxaA1RWraW997RW$$71Y7uAVDnPIg5w_9dKSOv",
    "target" : "kRAhWpuCBYITGEsDQdNdE$$78JwpmyT2I1zEnGJTXadn",
    "targetPort" : "8gQjLulONH4vDHmbT860Q$$e8v0t-3J8rTy7gte-qxO_"
  }, {
    "id" : "V892RPU_n58Q2wPF1o4PM",
    "source" : "kRAhWpuCBYITGEsDQdNdE$$78JwpmyT2I1zEnGJTXadn",
    "sourcePort" : "DhL-_cVWIPjBjaoZ4nhiq$$iXROxdHO1VLwVKu4FWDkH",
    "target" : "PQOLTdXX7yyiKT10fr_eR$$w-fNGp-QQFHCO_0YakWFh",
    "targetPort" : "-1F18vNkNNftFfB7KCzfB$$PtXx7qDYnxnPbmrSyHzot"
  }, {
    "id" : "-kprRNPgV2lvgabe0SU48",
    "source" : "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S",
    "sourcePort" : "lqDcEDYMFtjFo_AY7WlvY$$BkXNk5IYhdQ3RDsc3Byna",
    "target" : "rskdWEHw6vGPgyCisUKEa$$ysFMB8Lf1Vy7UUuou7FQx",
    "targetPort" : "2Qg4JuTlWgTXweoLhHJJ8$$QZdXosXMdXikDuMivCwKy"
  }, {
    "id" : "Y1g-yYhlExd3ZSMWbg_EV",
    "source" : "LEeXohVprXwfqpOzB3X0j$$9_LjfLjJJoWKqEHb4jms4",
    "sourcePort" : "0WkhAxSAn9TmJKRZCAYdQ$$6qxL-3PQ31fm-T_bxeFyU",
    "target" : "UEgQvQvWJqIv_Xb1rvnXW$$hXnErAzHWaHe0sQfeGCQ-",
    "targetPort" : "4TBwDPNSDJP4URrYhtSrd$$I9OHWoOz907XJNLRgQ-h7"
  }, {
    "id" : "SVh7R8-HOn0HAuerXwJUH",
    "source" : "WBKqqC0nfnPLkCgDDdJKZ$$oadXQ10S1st6_S4FIhXjU",
    "sourcePort" : "O_XyHZEnuKMPfn-7JlClk$$ROjRtq3Qy5Vbn28zwmHHu",
    "target" : "O4DQ3Fvx1p62sBuR7NcEV$$GNcN69TEwtsO8LvH2t_0V",
    "targetPort" : "biz3U3rk8gSdrDjKfkjBA$$8Wr3r-4cYoNUiRcmTHQnb"
  } ],
  "processes" : {
    "Ovegni1Ik2s62v3Y_KxzA$$Z7UtxkHpo8l4seeHGyTJz" : {
      "id" : "Ovegni1Ik2s62v3Y_KxzA$$Z7UtxkHpo8l4seeHGyTJz",
      "component" : "Source",
      "metadata" : {
        "label" : "ReportSCD2Source",
        "slug" : "ReportSCD2Source",
        "x" : 1320,
        "y" : 360,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "EKT04cbxaA1RWraW997RW$$71Y7uAVDnPIg5w_9dKSOv",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/ReportSCD2"
      }
    },
    "wfS3tSSomjQ63ydrAyeFN$$3Cvz4wtDJIU-Sm77itsJi" : {
      "id" : "wfS3tSSomjQ63ydrAyeFN$$3Cvz4wtDJIU-Sm77itsJi",
      "component" : "Source",
      "metadata" : {
        "label" : "LexisNexis",
        "slug" : "LexisNexis",
        "x" : 157.00000000000034,
        "y" : 420.8,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "-rz8MhLfHBlkbZ2nJBz31$$TLnXoClALuxirKNvjJIa8",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/BNPLjsonIngest"
      }
    },
    "N8XI4b0r41C98r4zJGXuY$$bwVgU5qdz8UYsK-G0EGLP" : {
      "id" : "N8XI4b0r41C98r4zJGXuY$$bwVgU5qdz8UYsK-G0EGLP",
      "component" : "Join",
      "metadata" : {
        "label" : "ByCustomerID",
        "slug" : "ByCustomerID",
        "x" : 340,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Z_q192QmqjgUxWDHvvuqy$$BiTJ-euN970OFDPstE4KF",
          "slug" : "in0",
          "isStreaming" : false
        }, {
          "id" : "51sdRfkjiTW8i3MV-BiCW$$AiYpxhPTrV1dCQMOXy3No",
          "slug" : "in1",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "ihSbdkfKW7G-TxkXIu58S$$DfsjIDeb-y5SlX1kgjbOE",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.CUSTOMER_NAME = in1.Name"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ ],
        "hints" : [ {
          "id" : "Z_q192QmqjgUxWDHvvuqy$$BiTJ-euN970OFDPstE4KF",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "51sdRfkjiTW8i3MV-BiCW$$AiYpxhPTrV1dCQMOXy3No",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "allIn1" : null,
        "activeTab" : "conditions",
        "columnsSelector" : [ "51sdRfkjiTW8i3MV-BiCW$$AiYpxhPTrV1dCQMOXy3No##Name", "Z_q192QmqjgUxWDHvvuqy$$BiTJ-euN970OFDPstE4KF##CUSTOMER_NAME" ],
        "allIn0" : null,
        "whereClause" : null,
        "headAlias" : "in0"
      }
    },
    "lY9BF_UpAoekPkG8V11tN$$6PPoFoXHN8BCUS126QJ2_" : {
      "id" : "lY9BF_UpAoekPkG8V11tN$$6PPoFoXHN8BCUS126QJ2_",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Refine",
        "slug" : "Refine",
        "x" : 360,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "sgKEun3wI8uK97QKsE5uh$$bNTxoEfSDHu6LyCVB_U-9",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "2Njm_vQelmN9u8aO-FLr_$$RgFvRuluavDy_PX75aEbw",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "Name",
          "expression" : {
            "format" : "sql",
            "expression" : "name"
          },
          "description" : ""
        }, {
          "target" : "MonthlyBNPLLoanAmount",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(monthly_loan_amount as long)"
          },
          "description" : ""
        }, {
          "target" : "Balance",
          "expression" : {
            "format" : "sql",
            "expression" : "balance"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "sgKEun3wI8uK97QKsE5uh$$bNTxoEfSDHu6LyCVB_U-9##balance", "sgKEun3wI8uK97QKsE5uh$$bNTxoEfSDHu6LyCVB_U-9##monthly_loan_amount", "sgKEun3wI8uK97QKsE5uh$$bNTxoEfSDHu6LyCVB_U-9##name" ]
      }
    },
    "OYaGutOo1n_DqxjKU-7G_$$R2yardQiDMwyz3efeWlLu" : {
      "id" : "OYaGutOo1n_DqxjKU-7G_$$R2yardQiDMwyz3efeWlLu",
      "component" : "Target",
      "metadata" : {
        "label" : "ReportSCD2",
        "slug" : "ReportSCD2",
        "x" : 1180,
        "y" : 360,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "8pBqFHg4j9yqVWrPgnCr5$$-gsoGb9UJxu4Wv0_AxPZ4",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/ReportSCD2"
      }
    },
    "kRAhWpuCBYITGEsDQdNdE$$78JwpmyT2I1zEnGJTXadn" : {
      "id" : "kRAhWpuCBYITGEsDQdNdE$$78JwpmyT2I1zEnGJTXadn",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "OrderBy",
        "slug" : "OrderBy",
        "x" : 1520,
        "y" : 360,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "8gQjLulONH4vDHmbT860Q$$e8v0t-3J8rTy7gte-qxO_",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "DhL-_cVWIPjBjaoZ4nhiq$$iXROxdHO1VLwVKu4FWDkH",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "8gQjLulONH4vDHmbT860Q$$e8v0t-3J8rTy7gte-qxO_##maxFlag" ],
        "orders" : [ {
          "expression" : {
            "format" : "sql",
            "expression" : "maxFlag"
          },
          "sortType" : "desc"
        } ]
      }
    },
    "nLIeU1vq5Y1haW-6Z5SHm$$bTVNtL8ujdRPnsmrmSeF8" : {
      "id" : "nLIeU1vq5Y1haW-6Z5SHm$$bTVNtL8ujdRPnsmrmSeF8",
      "component" : "Source",
      "metadata" : {
        "label" : "Income",
        "slug" : "Income",
        "x" : 160,
        "y" : 80,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "-DKYPXr6cpyCf0m3aYm9R$$ekx_RsHVb4LM-Y1iIieoW",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/CustIncomeCSV"
      }
    },
    "YRpIP1W9KuR198nbz1_kL$$6RHbqvxXN_BHsWC9nQOXb" : {
      "id" : "YRpIP1W9KuR198nbz1_kL$$6RHbqvxXN_BHsWC9nQOXb",
      "component" : "Target",
      "metadata" : {
        "label" : "ReportSCD1",
        "slug" : "ReportSCD1",
        "x" : 1180,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "FqNGAwu-FsXLmp-s6FpwA$$4B-nYdsGZ6z3SQcaaR6wu",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/Profile"
      }
    },
    "ya9_cxbGeuUPref1-HAu2$$4-hNZHhJpOOC8NbX7SpsE" : {
      "id" : "ya9_cxbGeuUPref1-HAu2$$4-hNZHhJpOOC8NbX7SpsE",
      "component" : "Join",
      "metadata" : {
        "label" : "ByName",
        "slug" : "ByName",
        "x" : 720,
        "y" : 280,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT",
          "slug" : "in0",
          "isStreaming" : false
        }, {
          "id" : "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk",
          "slug" : "in1",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "N_Zqvvvx1coa37Ndr7Pw_$$DJGIPh_qL8pwEgQfl7Ova",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.Name = in1.Name"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "target" : "Name",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.Name"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "ReportedIncome",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.ReportedIncome"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "TradLoanAmount",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.TULoanAmount"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "BNPLLoanAmount",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.MonthlyBNPLLoanAmount"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "Balance",
          "expression" : {
            "format" : "sql",
            "expression" : "in1.Balance"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "FicoScore",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.Score"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "FicoValidFrom",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.ValidFrom"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "FicoValidTo",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.ValidTo"
          },
          "description" : "",
          "_row_id" : null
        } ],
        "hints" : [ {
          "id" : "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "allIn1" : null,
        "activeTab" : "expressions",
        "columnsSelector" : [ "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk##Name", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##Name", "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk##Name", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##ValidTo", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##ValidFrom", "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk##Balance", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##Score", "AmXvPkRImmlAGCA2ZAeZV$$FlUq21CdC53CrPWTZEAFk##MonthlyBNPLLoanAmount", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##ReportedIncome", "3ZwTjTBHMDYA5PWUiCJNR$$UWsTvHdvA_9teojs6yvKT##TULoanAmount" ],
        "allIn0" : null,
        "whereClause" : null,
        "headAlias" : "in0"
      }
    },
    "PQOLTdXX7yyiKT10fr_eR$$w-fNGp-QQFHCO_0YakWFh" : {
      "id" : "PQOLTdXX7yyiKT10fr_eR$$w-fNGp-QQFHCO_0YakWFh",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_1",
        "slug" : "Filter_1",
        "x" : 1740,
        "y" : 360,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "-1F18vNkNNftFfB7KCzfB$$PtXx7qDYnxnPbmrSyHzot",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "t0_sQuUJ8VoqSrIgFB6OO$$hRRMGAycfoonb_w2TTLj7",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "-1F18vNkNNftFfB7KCzfB$$PtXx7qDYnxnPbmrSyHzot##maxFlag" ],
        "condition" : {
          "format" : "sql",
          "expression" : "maxFlag is true"
        }
      }
    },
    "UGvWJ-rcmwcFxAdXZbPM-$$U-Ppg_VPlLrEGh7royJKA" : {
      "id" : "UGvWJ-rcmwcFxAdXZbPM-$$U-Ppg_VPlLrEGh7royJKA",
      "component" : "Target",
      "metadata" : {
        "label" : "ReportLatest",
        "slug" : "ReportLatest",
        "x" : 1940,
        "y" : 360,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "2sH4WuE25a33TlKYWm9vI$$18YyvpQyJMvva6tdqrtHK",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/ReportLatest"
      }
    },
    "zOH5C3GtqrsEPwEFJGOLi$$T_JwgqlKsW9ud30cPrY_j" : {
      "id" : "zOH5C3GtqrsEPwEFJGOLi$$T_JwgqlKsW9ud30cPrY_j",
      "component" : "Reformat",
      "metadata" : {
        "label" : "ParseLoanAmount",
        "slug" : "ParseLoanAmount",
        "x" : 520,
        "y" : 160,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "2ZIMo6Fee-eMAmdjSDcvI$$A90_RUsr5enWOEWWLZx-Z",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "ReportedIncome",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(REPORTED_INCOME as long)"
          },
          "description" : ""
        }, {
          "target" : "Name",
          "expression" : {
            "format" : "sql",
            "expression" : "Name"
          },
          "description" : ""
        }, {
          "target" : "TULoanAmount",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(split(trades.trade[0].terms, 'M')[1] as long)"
          },
          "description" : ""
        }, {
          "target" : "Score",
          "expression" : {
            "format" : "sql",
            "expression" : "FICO.Score"
          },
          "description" : ""
        }, {
          "target" : "ValidFrom",
          "expression" : {
            "format" : "sql",
            "expression" : "FICO.ValidFrom"
          },
          "description" : ""
        }, {
          "target" : "ValidTo",
          "expression" : {
            "format" : "sql",
            "expression" : "FICO.ValidTo"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##REPORTED_INCOME", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##Trades", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##FICO.ValidTo", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##FICO.Score", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##Trades.Trade", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##Name", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##FICO", "qTWiiHRmcKjyeeFV8p3wd$$XbY68Ig8iJhug3pkxRmvW##FICO.ValidFrom" ]
      }
    },
    "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S" : {
      "id" : "POkx315yQfajWC4ytMxCb$$jYpANLStKcFXxuBo5vr5S",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Monthly",
        "slug" : "Monthly",
        "x" : 940,
        "y" : 280,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "lqDcEDYMFtjFo_AY7WlvY$$BkXNk5IYhdQ3RDsc3Byna",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "Name",
          "expression" : {
            "format" : "sql",
            "expression" : "Name"
          },
          "description" : ""
        }, {
          "target" : "Income",
          "expression" : {
            "format" : "sql",
            "expression" : "cast(ReportedIncome / 12 as long)"
          },
          "description" : ""
        }, {
          "target" : "LoanTotal",
          "expression" : {
            "format" : "sql",
            "expression" : "cast((TradLoanAmount + BNPLLoanAmount) as long)"
          },
          "description" : ""
        }, {
          "target" : "FicoScore",
          "expression" : {
            "format" : "sql",
            "expression" : "FicoScore"
          },
          "description" : ""
        }, {
          "target" : "FicoValidFrom",
          "expression" : {
            "format" : "sql",
            "expression" : "FicoValidFrom"
          },
          "description" : ""
        }, {
          "target" : "FicoValidTo",
          "expression" : {
            "format" : "sql",
            "expression" : "FicoValidTo"
          },
          "description" : ""
        }, {
          "target" : "minFlag",
          "expression" : {
            "format" : "sql",
            "expression" : "lit(true)"
          },
          "description" : ""
        }, {
          "target" : "maxFlag",
          "expression" : {
            "format" : "sql",
            "expression" : "lit(true)"
          },
          "description" : ""
        }, {
          "target" : "previousFicoScore",
          "expression" : {
            "format" : "sql",
            "expression" : "lit(\"None\")"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##FicoValidTo", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##FicoValidFrom", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##FicoScore", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##BNPLLoanAmount", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##Name", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##TradLoanAmount", "NBJ-lJBdSbAuZSRSU4c3q$$X9XztvKFjjeLwBPFiYpOc##ReportedIncome" ]
      }
    },
    "WBKqqC0nfnPLkCgDDdJKZ$$oadXQ10S1st6_S4FIhXjU" : {
      "id" : "WBKqqC0nfnPLkCgDDdJKZ$$oadXQ10S1st6_S4FIhXjU",
      "component" : "Source",
      "metadata" : {
        "label" : "RepordSCD1Source",
        "slug" : "RepordSCD1Source",
        "x" : 1320,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "O_XyHZEnuKMPfn-7JlClk$$ROjRtq3Qy5Vbn28zwmHHu",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/Profile"
      }
    },
    "UEgQvQvWJqIv_Xb1rvnXW$$hXnErAzHWaHe0sQfeGCQ-" : {
      "id" : "UEgQvQvWJqIv_Xb1rvnXW$$hXnErAzHWaHe0sQfeGCQ-",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "OrderBy_1",
        "slug" : "OrderBy_1",
        "x" : 1520,
        "y" : 540,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "4TBwDPNSDJP4URrYhtSrd$$I9OHWoOz907XJNLRgQ-h7",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "K4ffhDWpbytl4RLQxmYfD$$BokuWbDQZIXvr23x9-tPo",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "4TBwDPNSDJP4URrYhtSrd$$I9OHWoOz907XJNLRgQ-h7##Name" ],
        "orders" : [ {
          "expression" : {
            "format" : "sql",
            "expression" : "Name"
          },
          "sortType" : "asc"
        } ]
      }
    },
    "rskdWEHw6vGPgyCisUKEa$$ysFMB8Lf1Vy7UUuou7FQx" : {
      "id" : "rskdWEHw6vGPgyCisUKEa$$ysFMB8Lf1Vy7UUuou7FQx",
      "component" : "Target",
      "metadata" : {
        "label" : "ReportSCD3",
        "slug" : "ReportSCD3",
        "x" : 1180,
        "y" : 540,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "2Qg4JuTlWgTXweoLhHJJ8$$QZdXosXMdXikDuMivCwKy",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/ReportSCD3"
      }
    },
    "l7SQRH_R1q0GSjJVQBVUC$$7ImWPKlPUtMdxKnxHb1R7" : {
      "id" : "l7SQRH_R1q0GSjJVQBVUC$$7ImWPKlPUtMdxKnxHb1R7",
      "component" : "Script",
      "metadata" : {
        "label" : "Ingest",
        "slug" : "Ingest",
        "x" : 40,
        "y" : 240,
        "phase" : -1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true
      },
      "properties" : {
        "script" : "import os\n\nos.system(\"mkdir -p /dbfs/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO\")\nos.system('wget https://raw.githubusercontent.com/atbida/terraform-databricks-lakehouse-blueprints/main/industry/fsi/data/TransUnionFICO2018 -O /dbfs/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2018.xml')\nos.system('wget https://raw.githubusercontent.com/atbida/terraform-databricks-lakehouse-blueprints/main/industry/fsi/data/TransUnionFICO2019 -O /dbfs/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2019.xml')\nos.system('wget https://raw.githubusercontent.com/atbida/terraform-databricks-lakehouse-blueprints/main/industry/fsi/data/TransUnionFICO2020 -O /dbfs/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2020.xml')",
        "scriptMethodHeader" : "def Script(spark: SparkSession) -> None:",
        "scriptMethodFooter" : "    return "
      }
    },
    "wFcrkNKSMuoJ7FihqyJ80$$9gJQSesc8LZtVtMVywFEq" : {
      "id" : "wFcrkNKSMuoJ7FihqyJ80$$9gJQSesc8LZtVtMVywFEq",
      "component" : "Script",
      "metadata" : {
        "label" : "ClearDataPreDemo",
        "slug" : "ClearDataPreDemo",
        "x" : -160,
        "y" : 240,
        "phase" : -2,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true
      },
      "properties" : {
        "script" : "dbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2018.xml', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2019.xml', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2020.xml', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ingest/FICO/TransUnionFICO2021.xml', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ReportWithHistory', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ReportSCD3', recurse=True)\ndbutils.fs.rm('/Prophecy/sparklearner123@gmail.com/finserv/prophecy/ReportSCD1', recurse=True)\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession) -> None:",
        "scriptMethodFooter" : "    return "
      }
    },
    "KhKGpWIjs4Cl8SPLZTLfq$$-POKihJ5Q8C6wyL38xNAA" : {
      "id" : "KhKGpWIjs4Cl8SPLZTLfq$$-POKihJ5Q8C6wyL38xNAA",
      "component" : "Source",
      "metadata" : {
        "label" : "TransUnionFico.xml",
        "slug" : "TransUnionFico_xml",
        "x" : 160,
        "y" : 240,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "8dhc6TDyIigVGNa5lrrVF$$z2LiDxgpPswa2reGpVW0x",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/TransUnionFICOyear_xml"
      }
    },
    "O4DQ3Fvx1p62sBuR7NcEV$$GNcN69TEwtsO8LvH2t_0V" : {
      "id" : "O4DQ3Fvx1p62sBuR7NcEV$$GNcN69TEwtsO8LvH2t_0V",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "OrderBy_2",
        "slug" : "OrderBy_2",
        "x" : 1500,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "biz3U3rk8gSdrDjKfkjBA$$8Wr3r-4cYoNUiRcmTHQnb",
          "slug" : "in0",
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "3e-NJAiB2vj4t307L4R42$$wRw_7HuAFpSeCxmZIxW9P",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "biz3U3rk8gSdrDjKfkjBA$$8Wr3r-4cYoNUiRcmTHQnb##FicoValidTo" ],
        "orders" : [ {
          "expression" : {
            "format" : "sql",
            "expression" : "FicoValidTo"
          },
          "sortType" : "asc"
        } ]
      }
    },
    "LEeXohVprXwfqpOzB3X0j$$9_LjfLjJJoWKqEHb4jms4" : {
      "id" : "LEeXohVprXwfqpOzB3X0j$$9_LjfLjJJoWKqEHb4jms4",
      "component" : "Source",
      "metadata" : {
        "label" : "ReportSCD3_1",
        "slug" : "ReportSCD3_1",
        "x" : 1320,
        "y" : 540,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "0WkhAxSAn9TmJKRZCAYdQ$$6qxL-3PQ31fm-T_bxeFyU",
          "slug" : "out",
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "datasets/ReportSCD3"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false
  }
}